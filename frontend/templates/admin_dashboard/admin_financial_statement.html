{% extends 'admin_base.html' %}

{% block title %}Admin Financial Statement Dashboard{% endblock %}

{% block head %}
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
<link rel="stylesheet" href="{{ url_for('static', path='css/admin_dashboard.css') }}">
{% endblock %}

{% block content %}
<div class="dashboard-container">
  <h2 class="dashboard-header">Admin Financial Statement Dashboard</h2>

  <div class="quick-stats-container">
    <div class="stat-card">
      <h3>Total Current Balance</h3>
      <p>₱[Total Current Balance]</p>
    </div>
    <div class="stat-card">
      <h3>Total Revenue (YTD)</h3>
      <p>₱[Total Revenue YTD]</p>
    </div>
    <div class="stat-card">
      <h3>Total Expenses (YTD)</h3>
      <p>₱[Total Expenses YTD]</p>
    </div>
    <div class="stat-card">
      <h3>Net Income (YTD)</h3>
      <p>₱[Net Income YTD]</p>
    </div>
  </div>

  <div class="summary-info-container">
    <p><strong>Overall Balance Turnover:</strong> ₱[Balance Turnover]</p>
    <p><strong>Total Funds Available:</strong> ₱[Total Funds Available]</p>
    <p><strong>Reporting Date:</strong> [Reporting Date]</p>
  </div>

  <div class="report-toggle-container">
    <span class="report-toggle-label">Quick View:</span>
    <div class="report-toggle-buttons">
      <button class="report-toggle-button active" onclick="toggleView('overview')">Overview</button>
      <button class="report-toggle-button" onclick="toggleView('revenues')">Revenues</button>
      <button class="report-toggle-button" onclick="toggleView('expenses')">Expenses</button>
      <button class="report-toggle-button" onclick="toggleView('monthly')">Monthly</button>
      <button class="report-toggle-button" onclick="toggleView('accounts')">Accounts</button>
    </div>
  </div>

  <div id="overview" class="report-card active">
    <div class="report-header">
      <h2>Financial Overview</h2>
      <p>Key Financial Indicators</p>
    </div>
    <div class="report-body">
      <div class="overview-charts-container">
        <div class="chart-container">
          <h3>Revenue vs. Expenses (YTD)</h3>
          <canvas id="revenue-expense-chart" class="chart-canvas" ></canvas>
        </div>
        <div class="chart-container">
          <h3>Net Income Trend (Last 12 Months)</h3>
          <canvas id="net-income-trend-chart" class="chart-canvas" ></canvas>
        </div>
      </div>
      <div class="key-metrics-container">
        <div class="metric-card">
          <h4>Top Revenue Source</h4>
          <p>[Highest Revenue Source] (₱[Highest Revenue Amount])</p>
        </div>
        <div class="metric-card">
          <h4>Largest Expense</h4>
          <p>[Largest Expense Category] (₱[Largest Expense Amount])</p>
        </div>
        <div class="metric-card">
          <h4>Profit Margin (YTD)</h4>
          <p>[Profit Margin YTD]%</p>
        </div>
      </div>
    </div>
  </div>

  <div id="revenues" class="report-card">
    <div class="report-header">
      <h2>Revenue Breakdown</h2>
      <p>Detailed Income Sources</p>
    </div>
    <div class="report-body">
      <table class="data-table">
        <thead>
          <tr>
            <th>Source</th>
            <th>Amount (₱)</th>
            <th>Trend</th>
            <th>% of Total</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>[Revenue Source 1]</td>
            <td class="amount">₱[Revenue 1 Amount]</td>
            <td><span class="trend">[Revenue 1 Trend]</span></td>
            <td>[Revenue 1 Percentage]%</td>
          </tr>
          <tr>
            <td>[Revenue Source 2]</td>
            <td class="amount">₱[Revenue 2 Amount]</td>
            <td><span class="trend">[Revenue 2 Trend]</span></td>
            <td>[Revenue 2 Percentage]%</td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <th>Total Revenue:</th>
            <th class="amount">₱[Total Revenue YTD]</th>
            <th></th>
            <th>100%</th>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>

  <div id="expenses" class="report-card">
    <div class="report-header">
      <h2>Expense Breakdown</h2>
      <p>Detailed Expenditures</p>
    </div>
    <div class="report-body">
      <table class="data-table">
        <thead>
          <tr>
            <th>Category</th>
            <th>Amount (₱)</th>
            <th>Trend</th>
            <th>% of Total</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>[Expense Category 1]</td>
            <td class="amount">₱[Expense 1 Amount]</td>
            <td><span class="trend">[Expense 1 Trend]</span></td>
            <td>[Expense 1 Percentage]%</td>
          </tr>
          <tr>
            <td>[Expense Category 2]</td>
            <td class="amount">₱[Expense 2 Amount]</td>
            <td><span class="trend">[Expense 2 Trend]</span></td>
            <td>[Expense 2 Percentage]%</td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <th>Total Expenses:</th>
            <th class="amount">₱[Total Expenses YTD]</th>
            <th></th>
            <th>100%</th>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>

  <div id="monthly" class="report-card">
    <div class="report-header">
      <h2>Monthly Summary</h2>
      <p>Income and Expenses by Month</p>
    </div>
    <div class="report-body">
      <div class="monthly-summary-table">
        <table class="data-table">
          <thead>
            <tr>
              <th>Month</th>
              <th>Revenue (₱)</th>
              <th>Expenses (₱)</th>
              <th>Net Income (₱)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>January</td>
              <td class="amount positive">₱[January Revenue]</td>
              <td class="amount negative">₱[January Expenses]</td>
              <td class="amount [January Net Income Class]">₱[January Net Income]</td>
            </tr>
            <tr>
              <td>February</td>
              <td class="amount positive">₱[February Revenue]</td>
              <td class="amount negative">₱[February Expenses]</td>
              <td class="amount [February Net Income Class]">₱[February Net Income]</td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <th>Year Total:</th>
              <th class="amount positive">₱[Total Revenue YTD]</th>
              <th class="amount negative">₱[Total Expenses YTD]</th>
              <th class="amount [Net Income YTD Class]">₱[Net Income YTD]</th>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>

  <div id="accounts" class="report-card">
    <div class="report-header">
      <h2>Account Balances</h2>
      <p>Current Balances in All Accounts</p>
    </div>
    <div class="report-body">
      <table class="data-table">
        <thead>
          <tr>
            <th>Account</th>
            <th>Balance (₱)</th>
            <th>Last Transaction</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>[Account Name 1]</td>
            <td class="amount">₱[Account 1 Balance]</td>
            <td>[Account 1 Last Transaction]</td>
            <td class="[Account 1 Status Lowercase]">[Account 1 Status]</td>
          </tr>
          <tr>
            <td>[Account Name 2]</td>
            <td class="amount">₱[Account 2 Balance]</td>
            <td>[Account 2 Last Transaction]</td>
            <td class="[Account 2 Status Lowercase]">[Account 2 Status]</td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <th>Total Balance:</th>
            <th class="amount">₱[Total Current Balance]</th>
            <th></th>
            <th></th>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  function toggleView(viewId) {
    const reportCards = document.querySelectorAll('.report-card');
    const toggleButtons = document.querySelectorAll('.report-toggle-button');

    reportCards.forEach(card => {
      card.classList.remove('active');
      if (card.id === viewId) {
        card.classList.add('active');
      }
    });

    toggleButtons.forEach(button => {
      button.classList.remove('active');
      if (button.textContent.toLowerCase().includes(viewId)) {
        button.classList.add('active');
      }
    });

    // --- Initialize Charts (Conceptual) ---
    if (viewId === 'overview') {
      //  Replace this with your actual chart rendering code using Chart.js
      //  Example (Conceptual):
      const revenueExpenseCtx = document.getElementById('revenue-expense-chart');
      if (revenueExpenseCtx) {
        new Chart(revenueExpenseCtx, {
          type: 'bar',
          data: {
            labels: ['Revenue', 'Expenses'],
            datasets: [{
              label: 'Year-to-Date (₱)',
              data: [1000000, 750000], // Example Data
              backgroundColor: ['rgba(54, 162, 235, 0.7)', 'rgba(255, 99, 132, 0.7)'],
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: true,
            scales: {
              y: {
                beginAtZero: true,
                grid: {
                  color: 'rgba(0, 0, 0, 0.1)', // Light grid lines
                  lineWidth: 0.5
                }
              },
              x: {
                grid: {
                  display: false
                }}
            },
            plugins: {
              legend: {
                position: 'bottom',
              },
              tooltip: {
                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                titleColor: '#fff',
                bodyColor: '#fff',
                borderColor: 'rgba(0, 0, 0, 0.8)',
                borderWidth: 1,
                animationDuration: 200
              }
            },
            animation: {
              duration: 1000,
              easing: 'easeInOutQuart'
            }
          }
        });
      }

      const netIncomeCtx = document.getElementById('net-income-trend-chart');
      if (netIncomeCtx) {
        new Chart(netIncomeCtx, {
          type: 'line',
          data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            datasets: [{
              label: 'Net Income (₱)',
              data: [50000, 60000, 70000, 80000, 90000, 100000, 110000, 120000, 130000, 140000, 150000, 160000], // Example Data
              borderColor: 'rgba(75, 192, 192, 1)',
              borderWidth: 3,
              fill: false,
              pointRadius: 6,
              pointBackgroundColor: 'rgba(75, 192, 192, 1)',
              pointHoverRadius: 8,
              pointHoverBackgroundColor: 'rgba(75, 192, 192, 1)',
              tension: 0.4, // Add some curve
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: true,
            scales: {
              y: {
                beginAtZero: true,
                grid: {
                  color: 'rgba(0, 0, 0, 0.1)',
                  lineWidth: 0.5
                },
              },
              x: {
                grid: {
                  color: 'rgba(0, 0, 0, 0.1)',
                  lineWidth: 0.5
                }
              }
            },
            plugins: {
              legend: {
                position: 'bottom'
              },
              tooltip: {
                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                titleColor: '#fff',
                bodyColor: '#fff',
                borderColor: 'rgba(0, 0, 0, 0.8)',
                borderWidth: 1,
                animationDuration: 200,
                yAlign: 'bottom',
                intersect: false
              }
            },
            animation: {
              duration: 1200,
              easing: 'easeInOutCubic'
            },
            elements: {
              line: {
                capStyle: 'round',
                joinStyle: 'round',
              }
            }
          }
        });
      }
    }
  }

  // Initially show the overview
  document.addEventListener('DOMContentLoaded', function () {
    toggleView('overview');
  });
</script>
{% endblock %}
